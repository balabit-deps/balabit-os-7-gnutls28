From 6b5cbc9ea5bdca704bdbe2f8fb551f720d634bc6 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Tim=20R=C3=BChsen?= <tim.ruehsen@gmx.de>
Date: Tue, 12 Feb 2019 15:20:23 +0100
Subject: [PATCH] gnutls_x509_crt_init: Fix dereference of NULL pointer
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Tim RÃ¼hsen <tim.ruehsen@gmx.de>
---
 lib/x509/x509.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: gnutls28-3.5.18/lib/x509/x509.c
===================================================================
--- gnutls28-3.5.18.orig/lib/x509/x509.c	2019-05-28 13:17:18.736815987 -0400
+++ gnutls28-3.5.18/lib/x509/x509.c	2019-05-28 13:17:18.732815969 -0400
@@ -223,8 +223,8 @@ int gnutls_x509_crt_init(gnutls_x509_crt
 	if (result < 0) {
 		gnutls_assert();
 		asn1_delete_structure(&tmp->cert);
-		gnutls_free(tmp);
 		gnutls_subject_alt_names_deinit(tmp->san);
+		gnutls_free(tmp);
 		return result;
 	}
 
